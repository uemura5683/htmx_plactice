<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>WebSockets & SSE</title>
    <script src="https://unpkg.com/htmx.org@1.9.11"></script>
  </head>
  <body>
    <h2>
      <a
        href="https://qiita.com/twrcd1227/items/7bce18167fb02ec22729#websockets--sse"
      >
        WebSockets & SSE
      </a>
    </h2>
    <div>
      WebSocketはサーバ側とユーザ側が常にオンライン状態を維持することによって、双方向通信を実現できる。リアルタイムに情報を共有できるチャットアプリケーションなどで用いられる。<br />
      SSE(Server-Sent
      Events)とは、サーバー送信イベントと呼ばれ、Webブラウザーとサーバー間の一方向の非同期通信方法のこと。SSEは、長時間接続でもリソース消費が少ないため、リアルタイムな通信に向いている。<br />
    </div>
    <h2>Web Socket</h2>
    <div>導入するには、まず以下スクリプトを読み込む。</div>
    <code>
      <pre style="background: black; color: white">

    &lt;script src="https://unpkg.com/htmx.org/dist/ext/ws.js"&gt;&lt;/script&gt;
      </pre>
    </code>
    <div>
      hx-ext="ws"を指定できるようになり、Web Socketを使えるようになる。<br />
      また、2つの属性が使えるようになる。<br />
    </div>
    <code>
      <pre style="background: black; color: white">

    属性	説明
    ws-connect="&lt;url&gt;"
    ws-connect="&lt;prefix&gt;:&lt;url&gt;"	WebSocket接続先URL
    ws-send	要素のトリガー値に基づいて、最も近いWebSocketにメッセージを送信する。
    以下のように指定する。
      </pre>
    </code>
    <div>以下のように指定する。</div>
    <code>
      <pre style="background: black; color: white">

    &lt;div hx-ext="ws" ws-connect="/chatroom"&gt;
      &lt;div id="notifications">&lt;/div&gt;
      &lt;div id="chat_room"&gt;
        ...
      &lt;/div&gt;
      &lt;form id="form" ws-send&gt;
        &lt;input name="chat_message"&gt;
      &lt;/form&gt;
    &lt;/div&gt;
      </pre>
    </code>
    <div>
      2つの設定オブションがある。<br>
      <br>
      オプション名	説明<br>
      createWebSocket	カスタムWebSocketインスタンスの作成に<br>
      使用できるファクトリ関数<br>
      wsBinaryType	ソケットのbinaryTypeのプロパティを定義する文字列。<br>
      デフォルトはblob
    </div>
  </body>
</html>
